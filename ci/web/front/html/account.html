<centered-panel id="account">
	<div id="accountOptions">
		<menu>
			<menu-header menu-header-padding>{{name}}</menu-header>
			<menu-options>
				<menu-option menu-option-text="My Account" ng-click="menuOptionClick('basic')" ng-class="{selected: currentView == 'basic', green: currentView == 'basic'}"></menu-option>
				<menu-option menu-option-text="Password" ng-click="menuOptionClick('password')" ng-class="{selected: currentView == 'password', green: currentView == 'password'}"></menu-option>
				<menu-option menu-option-text="SSH Keys" ng-click="menuOptionClick('sshKeys')" ng-class="{selected: currentView == 'sshKeys', green: currentView == 'sshKeys'}"></menu-option>
			</menu-options>
		</menu>
	</div>

	<div id="accountBasic" ng-show="currentView == 'basic'" ng-controller="AccountBasic">
		<menu-content>
			<menu-content-header menu-content-header-padding>My Account</menu-content-header>
			<menu-content-body unselectable>
				<div id="accountBasicContent">
					<styled-form name="basicForm">
						<styled-form-field label="First name" label-padding="true">
							<input type="text" ng-model="account.firstName" name="firstName" placeholder="First" ng-pattern="/^[A-Z][-'a-zA-Z]+$/" ng-maxlength="64" autocomplete="on" required focused>
							<span class="prettyFormError" tooltip="Invalid first name" ng-class="{visible: basicForm.firstName.$dirty && basicForm.firstName.$invalid}">
								<img ng-src="{{'/img/icons/error.png' | fileSuffix}}">
							</span>
						</styled-form-field>
						<styled-form-field label="Last name" label-padding="true">
							<input type="text" ng-model="account.lastName" name="lastName" placeholder="Last" ng-pattern="/^[A-Z][-'a-zA-Z]+$/" ng-maxlength="64" autocomplete="on" required>
							<span class="prettyFormError" tooltip="Invalid last name" ng-class="{visible: basicForm.lastName.$dirty && basicForm.lastName.$invalid}">
								<img ng-src="{{'/img/icons/error.png' | fileSuffix}}">
							</span>
						</styled-form-field>
					</styled-form>

					<div id="accountBasicButtonContainer">
						<button ng-click="submit()" ng-disabled="basicForm.$invalid">Save Changes</button>
					</div>
				</div>
			</menu-content-body>
		</menu-content>
	</div>

	<div id="accountPassword" ng-show="currentView == 'password'" ng-controller="AccountPassword">
		<menu-content>
			<menu-content-header menu-content-header-padding>Password</menu-content-header>
			<menu-content-body unselectable>
				<div id="accountPasswordContent">
					<styled-form name="passwordForm">
						<styled-form-field label="Old password" label-padding="true">
							<input type="password" ng-model="account.oldPassword" name="oldPassword" placeholder="old p4ssW0rd" required focused>
						</styled-form-field>
						<styled-form-field label="New password" label-padding="true">
							<input type="password" ng-model="account.newPassword" name="newPassword" placeholder="new p4ssW0rd" ng-pattern="/^(?=.*[a-zA-Z])(?=.*\d).+$/" ng-minlength="8" ng-maxlength="256" required>
							<span class="prettyFormError" tooltip="Password must contain at least 8 characters, a letter, and a number" ng-class="{visible: passwordForm.newPassword.$dirty && passwordForm.newPassword.$invalid}">
								<img ng-src="{{'/img/icons/error.png' | fileSuffix}}">
							</span>
						</styled-form-field>
						<styled-form-field label="Confirm password" label-padding="true">
							<input type="password" ng-model="account.confirmPassword" name="confirmPassword" placeholder="p4ssW0rd, again" ng-pattern="/^(?=.*[a-zA-Z])(?=.*\d).+$/" ng-minlength="8" ng-maxlength="256" required>
							<span class="prettyFormError" tooltip="Passwords do not match" ng-class="{visible: passwordForm.confirmPassword.$dirty && account.newPassword != account.confirmPassword}">
								<img ng-src="{{'/img/icons/error.png' | fileSuffix}}">
							</span>
						</styled-form-field>
					</styled-form>

					<div id="accountPasswordButtonContainer">
						<button ng-click="submit()" ng-disabled="passwordForm.$invalid">Save Changes</button>
					</div>
				</div>
			</menu-content-body>
		</menu-content>
	</div>

	<div id="accountSshKeys" ng-show="currentView == 'sshKeys'" ng-controller="AccountSshKeys">
		<menu-content>
			<menu-content-header menu-content-header-padding>SSH Keys<span id="addSshKeyLink" ng-click="addKey.modalVisible=true">+ Add a New SSH Key</span></menu-content-header>
			<menu-content-body unselectable>
				<div id="accountSshKeysContent">
					<table class="prettyTable">
						<tr class="title">
							<td class="aliasColumn" ng-click="orderByPredicate = 'alias'; orderByReverse = !orderByReverse">Alias</td>
							<td class="createdColumn" ng-click="orderByPredicate = 'timestamp'; orderByReverse = !orderByReverse">Created</td>
							<td class="removeColumn">Remove</td>
						</tr>

						<tr ng-show="keys.length == 0">
							<td class="aliasColumn" text-selectable>You don't have any SSH keys for this account</td>
							<td class="createdColumn"></td>
							<td class="removeColumn"></td>
						</tr>

						<tr ng-repeat="key in keys | orderBy:orderByPredicate:orderByReverse">
							<td class="aliasColumn" text-selectable>{{key.alias}}</td>
							<td class="createdColumn" text-selectable>{{key.timestamp*1000 | date:'MM/dd/yyyy'}}</td>
							<td class="removeColumn"><span class="removeLink" ng-click="removeKey(key)">Delete</span></td>
						</tr>
					</table>
				</div> 
			</menu-content-body>
		</menu-content>

		<modal modal-visible="addKey.modalVisible">
			<div id="accountAddSshKey">
				<menu-content>
					<menu-content-header menu-content-header-padding>Add a New SSH Key</menu-content-header>
					<menu-content-body unselectable>
						<div id="accountAddSshKeyContent">
							<styled-form name="addSshKeyForm" id="accountAddSshKeyForm">
								<styled-form-field label="Alias" label-padding="true">
									<input type="text" ng-model="addKey.alias" name="alias" placeholder="Alias" ng-maxlength="64" required>
								</styled-form-field>
								<styled-form-field label="Key" label-padding="true">
									<textarea type="text" ng-model="addKey.key" name="key" placeholder="Key" ng-pattern="/^ssh-(?:dss|rsa) [A-Za-z0-9+/]+={0,2}/" ng-maxlength="8192" required></textarea>
									<span class="prettyFormError" tooltip="Invalid key" ng-class="{visible: addSshKeyForm.key.$dirty && addSshKeyForm.key.$invalid}">
										<img ng-src="{{'/img/icons/error.png' | fileSuffix}}">
									</span>
								</styled-form-field>
							</styled-form>

							<div id="accountAddSshKeyButtonContainer">
								<button ng-click="submitKey()" ng-disabled="addSshKeyForm.$invalid">Add Key</button>
							</div>
						</div>
					</menu-content-body>
				</menu-content>
			</div>
		</modal>
	</div>
</centered-panel>
